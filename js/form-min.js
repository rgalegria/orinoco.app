const promoForm=document.getElementById("promo-form"),form=document.getElementById("payment-details"),customerDetails=document.getElementById("customer-details"),emailInput=document.getElementById("email"),firstNameInput=document.getElementById("first-name"),lastNameInput=document.getElementById("last-name"),addressInput=document.getElementById("address"),addressComplementInput=document.getElementById("address-complement"),cityInput=document.getElementById("city"),countryInput=document.getElementById("country"),cardNumberInput=document.getElementById("card-number"),cardOwnerInput=document.getElementById("card-owner"),cardMonthInput=document.getElementById("card-month"),cardYearInput=document.getElementById("card-year"),cardCodeInput=document.getElementById("card-cvv"),salesCodeCodeInput=document.getElementById("sales-code"),newsletterResult=document.getElementById("newsletter"),userDetailsResult=document.getElementById("user-details"),submitButton=document.getElementById("submit-btn"),apiPostUrl="https://orinoco-backend.herokuapp.com/api/cameras/order/",postOrder=async e=>{let t=await fetch(apiPostUrl,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(e)}),d=await t.json();window.location.assign(`../order/index.html?id=${d.orderId}&total=${totalCart}`)},validateForm=()=>{const e=/^[a-zA-Z- àáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð]{2,30}$/,t=validateField(emailInput,/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1, 3}\.[0-9]{1, 3}\.[0-9]{1, 3}\.[0-9]{1, 3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),d=validateField(lastNameInput,e),a=validateField(firstNameInput,e),n=validateField(addressInput,/^\d{1,7}( |-)?([a-zA-Z]|\d)*(\s[a-zA-Z-\'?]+\.?){1,3}/),s=validateField(cityInput,/^[a-zA-Z- àáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð]{1,85}$/);return!!(t&&d&&a&&n&&!0===s)},validateField=(e,t)=>{let d=new RegExp(t,"g").test(e.value);return d?e.classList.contains("error")?(e.classList.remove("error"),e.classList.add("good")):e.classList.add("good"):e.classList.contains("good")?(e.classList.remove("good"),e.classList.add("error")):e.classList.add("error"),d};form.addEventListener("submit",async e=>{if(e.preventDefault(),!0===validateForm()){let e=[],t=getCart();for(productIndex in t)e.push(t[productIndex].id);await postOrder({contact:{firstName:firstNameInput.value,lastName:lastNameInput.value,address:addressInput.value,city:cityInput.value,email:emailInput.value},products:e}),form.reset()}else alert("Veillez vérifier les informations dans les champs en rouge")}),document.getElementById("newsletter").addEventListener("change",e=>{e.target.checked}),document.getElementById("user-details").addEventListener("change",e=>{e.target.checked});